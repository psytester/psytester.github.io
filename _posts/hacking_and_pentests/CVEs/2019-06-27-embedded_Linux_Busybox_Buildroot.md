---
layout: post
title:  "Attack vector based on outdated embedded Linux Busybox/Buildroot releases"
date:   2019-06-27 15:00:00
author: 'psytester'
---

Veraltete Busybox oder Buildroot Versionen können zu einem Problem werden.<br>
<br>
Heutzutage ist Software Pflege das A und O um nicht verwundbar zu sein.<br>
Die Hersteller sind in guter Gesellschaft, es ist keiner Besser als der andere. Viele setzen teilweise veraltete oder sehr veraltete Versionen ein!<br>
<br>
Wichtig zu wissen: Das Datum in der Versionsausgabe von Busybox ist das Datum der Kompilierung und nicht das Release Datum!<br>
Es gibt alleine 17 CVEs zur Busybox als eigenständiges Produkt:<br>
https://www.cvedetails.com/product/7452/Busybox-Busybox.html?vendor_id=4282<br>
Und es gab weitere Sicherheitsupdates, die nicht explizit als CVE bekannt geworden sind.<br>
Zumindest die bekannten Lücken im DHCP und NTP wären dann eine Angriffsmöglichkeit.<br>
<br>
<br>
Und die Buildroot in einigen Systemen ist wahrscheinlich noch viel mehr betroffen<br>
https://git.busybox.net/buildroot/plain/CHANGES<br>
Alle CVEs aufgelistet in den Commits, 50 Einträge pro Seite<br>
https://git.busybox.net/buildroot/log/?qt=grep&q=CVE<br>
https://git.busybox.net/buildroot/log/?qt=grep&q=CVE&ofs=900<br>
Stand heute 2019-06-27 sind es 900 Seiten, in Summe 899 * 50 + 32 == Updates wegen 44.982 CVEs !!!<br>
<br>
<br>
<br>
Bisher habe ich drei Anfragen mit dieser Fragestellung rausgeschickt
```
Ist ihnen die veraltete Busybox/Buildroot „Problematik“ bewusst und gibt es allgemeine Bestrebungen Firmware Releases auf neuerer Basis rauszubringen?
Zumindest die bekannten Lücken im DHCP und NTP wären dann eine Angriffsmöglichkeit.
```

Dazu habe ich zwei Antworten erhalten<br>
<br>
Anfrage an Utimaco zu deren HSM Se2 Se1500 mit der Firmware FIPS-5.0.10.1, da diese eine BusyBox Installation besitzt.
```
strings /mnt/busybox/bin/busybox |grep "v1."
BusyBox v1.19.4 (2016-03-02 16:57:18 GMT)
```
Die Busybox Version ist nicht vom 2016-03-02, da wurde sie nur kompiliert.<br>
Die Version 1.19.4 wurde am 04.02.2012 Released und ist somit mit nun 7 Jahren deutlich älter (https://www.busybox.net/oldnews.html)<br>
<br>
Antwort vom Utimaco Support:<br>
```
Busybox wird nur beim Hochfahren der CSLAN und beim booten in earlyboot benutzt.
Wenn die CSLAN gestartet wird, wird der init-Prozess ausgeführt; dieser mounted die Partitionen und startet das Linux from Scratch Betriebssystem.
Erst durch das LFS-Betriebssystem wird der Netzwerkstack und die benötigten Dienste gestartet.
Busybox wird zu diesem Zeitpunkt nicht mehr benutzt;
Die Busybox Sicherheitslücken sind damit im Betrieb des CryptoServer LAN nicht mehr relevant.
```
<br>
Dann möchte ich das mal glauben
<br>
<br>

Anfrage an AVM zu deren Produkten
```
Die FRITZ.Box 7490
    Die Firmware 06.93 enthält die Buildroot 2013.05 und BusyBox 1.22.1 (stable) vom 20 January 2014
    Die Firmware 07.01 und 7.11 enthalten die Buildroot 2016.05 und BusyBox 1.24.2 (stable) vom 24 March 2016

Der FRITZ.Box WLAN Repeater 1750E
    Die Firmware 06.93 enthält die Buildroot 2013.05
    Die Firmware 07.01 und 07.10 enthalten die Buildroot 2016.05
```

Antwort vom AVM Support:
```
Vielen Dank für Ihren Hinweis. Bzgl. der von Ihnen angeführten Schwachtstellen im Bereich dhcp und ntp können wir entwarnung geben: Fritz!OS verwendet keine dieser Funktionen aus dem Busybox-Projekt.
Wir nehmen Ihr Schreiben dennoch zum Anlass, die Integration neuerer Busybox-Versionen in künftige FRITZ!OS-Releases zu prüfen.
```

(Noch) nicht nachgefragt habe ich bei Netgear zu deren Produkten, aber da wird eingesetzt:
```
R8000 – Nighthawk X6 – AC3200 Tri-Band-Gigabit-WLAN-Router
R8000-V1.0.4.28_10.1.54.zip und auch die R8000-V1.0.4.40_10.1.60_BETA.zip
	BusyBox v1.7.2 --> Releasedatum 10 September 2007 !

NETGEAR Nighthawk Gaming WLAN Router XR700 Pro
XR700-V1.0.1.8.zip
	BusyBox v1.4.2  --> Releasedatum 18 March 2007 !
```
Ist das Wahr?
<br>
Beim Schreiben dieses Artikel möchte ich das für die Busybox glauben, habe aber durch die Recherchen zu der Anzahl der CVEs in der Buildroot Zweifel bei den Produkten die auf einen Buildroot Release aufbauen.<br>
<br>
<br>
<br>
Die Spiele können beginnen und ich bin kein professioneller Pentester.....

# Disclaimer

The information provided is released "as is" without warranty of any kind. The publisher disclaims all warranties, either express or implied, including all warranties of merchantability. No responsibility is taken for the correctness of this information.
In no event shall the publisher be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if the publisher has been advised of the possibility of such damages.

The contents of this advisory are copyright (c) 2019 by psytester and may be distributed freely provided that no fee is charged for this distribution and proper credit is given.
