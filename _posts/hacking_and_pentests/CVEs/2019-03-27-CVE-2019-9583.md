---
layout: post
title:  "CVE-2019-9583 eQ-3 Homematic CCU2 and CCU3 obtain session IDs without login. This allows a Denial of Service and other attacks"
date:   2019-07-15 00:30:00 MEST
author: 'psytester'
---

# to be published July 2019

# Overview

- CVE: CVE-2019-9583
- Title: eQ-3 Homematic CCU2 and CCU3 obtain session IDs without login. This allows a Denial of Service and other attacks
- Vulnerability Type: CWE-400 Uncontrolled Resource Consumption
-	CVSSv3 Base Score: x.y
-	CVSSv3 Vector: CVSS:3.0/....
- Date: 15.07.2019
- Updated: --
- Author: psytester
- Vendor: eQ-3 AG	
- Product: Homematic CCU2 and CCU3
- Vendor contacted: 07.05.2019
- Vendor confirmation: N.A.
- Vendor patch: Just partly fixed since 2.47.10 & 3.47.10
- Vendor Reference: [HMCCU-274] in changelog of CCU2 and CCU3
- Affected Firmware version of CCU2: 2.35.16, 2.41.5, 2.41.8, 2.41.9, 2.45.6, 2.45.7, 2.47.10, 2.47.12 tested
- Affected Firmware version of CCU3: 3.41.11, 3.43.16, 3.45.5, 3.45.7, 3.47.10 tested

# Background

....

From the vendor's website:<br>
HomeMatic Central Control Unit CCU2

Homematic Central Control Unit is the central element of your Homematic system, offering a whole range of control, monitoring and configuration options for all the Homematic devices in your installation<br>
[....]<br>
With its smart home products, eQ-3 is a market leader and, by integrating IPv6 into mass-market home control products, the company is already turning the oft-quoted vision of the Internet of Things (IoT) into a reality.

# Issue Description

..

The following HTTP request illustrates the attack:

```http
GET .... HTTP/1.1
Host: 1.2.3.4
....
```

Response of the .... system under attack:

```
....
```
My PoC to find the DoS in process ....:
~~~python
#! /usr/bin/python3

# Exploit Title: Homematic CCU2 and CCU3 WebUI Login Denial Of Service detector
# Date: 15.05.2019
# Update: 27.06.2019
# Exploit Author: psytester
# Vendor Homepage: https://www.eq-3.de
# Software Link: https://www.eq-3.de/service/downloads.html
# CCU2 Version: <= 2.45.7
# CCU3 Version: <= 3.45.7
# CCU2 Version: 2.47.10 & 2.47.12 just partly fixed .....
# CCU3 Version: 3.47.10 just partly fixed .....
# The OCCU opensource variants are affected too!
# CVE : CVE-2019-9583
....
....
# Description: https://psytester.github.io/CVE-2019-XXXX


import http.client
import time
import os
....
~~~
# CVE

[CVE-2019-9583](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-9583)

# CVSSv3 Base Score

CVSSv3 Base Score: x.y

CVSSv3 Vector: CVSS:3.0/....

# Credit

[psytester](https://psytester.github.io)

Not owning an original CCU2 or CCU3, but you want to analyze the CCU 'for free'?<br>
You can download<br>
[piVCCU](https://github.com/alexreinert/piVCCU) for running the original CCU3 Firmware in lxc container on RaspberryPi<br>
[RaspberryMatic](https://github.com/jens-maus/RaspberryMatic) for running the opensource OCCU based release on different boards<br>

# Disclaimer

The information provided is released "as is" without warranty of any kind. The publisher disclaims all warranties, either express or implied, including all warranties of merchantability. No responsibility is taken for the correctness of this information.
In no event shall the publisher be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if the publisher has been advised of the possibility of such damages.

The contents of this advisory are copyright (c) 2019 by psytester and may be distributed freely provided that no fee is charged for this distribution and proper credit is given.
