---
layout: post
title:  "CVE-2019-13030 eQ-3 Homematic CCU3 AddOn 'Mediola NEO Server for Homematic CCU3' prior 2.4.5 allows uncontrolled admin access to start or stop the Node.js process, resulting in the ability to obtain mediola configuration details. This is related to improper access control for addons/mediola/index.html and addons/mediola/bin/restart.cgi, and a missing check in rc.d/97NeoServer"
date:   2019-07-15 00:50:00 MEST
author: 'psytester'
---

# to be published July 2019

# Overview

- CVE: CVE-2019-13030
- Author: psytester
- Title: Homematic CCU3 AddOn 'Mediola NEO Server for Homematic CCU3' prior 2.4.5 allows uncontrolled admin access to start or stop the Node.js process, resulting in the ability to obtain mediola configuration details. This is related to improper access control for addons/mediola/index.html and addons/mediola/bin/restart.cgi, and a missing check in rc.d/97NeoServer
- Vulnerability Type: CWE-284: Improper Access Control
-	CVSSv3 Base Score: x.y
-	CVSSv3 Vector: CVSS:3.0/....
- Publishing Date: 25.07.2019
- Updated: --
- Vendor: eQ-3 AG	for CCU3 Firmware containing from mediola - connected living AG the 'NEO Server' AddOn
- Product: Homematic CCU3 'NEO Server' AddOn
- Vendor eQ-3 contacted: 13.02.2019
- Vendor eQ-3 response on 11.04.2019 with "not responsible for AddOns"
- Vendor Mediola contacted: 12.04.2019
- Vendor Mediola confirmation: 18.04.2019
- Vendor patch: Just partly fixed since NEO Server for Homematic CCU3 v2.4.5
- Vendor eQ-3 for Homematic CCU3 patch: CCU3 3.47.10 contains NEO Server v2.4.5
- Vendor Reference: N.A.
- Affected Firmware version of CCU3: 3.41.11, 3.43.16, 3.45.5, 3.45.7 tested
- Affected 'NEO Server' Addon version: up to 2.4.4

# Background

....

From the vendor's website:
....

# Issue Description

..

The following HTTP request illustrates the attack:

```http
GET .... HTTP/1.1
Host: 1.2.3.4
....
```

Response of the .... system under attack:

```
....
```

# CVE

[CVE-2019-13030](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-13030)

# CVSSv3 Base Score

CVSSv3 Base Score: x.y

CVSSv3 Vector: CVSS:3.0/....

# Credit

[psytester](https://psytester.github.io)

Not owning an original CCU2 or CCU3, but you want to analyze the CCU 'for free'?<br>
You can download<br>
[piVCCU](https://github.com/alexreinert/piVCCU) for running the original CCU3 Firmware in lxc container on RaspberryPi<br>
[RaspberryMatic](https://github.com/jens-maus/RaspberryMatic) for running the opensource OCCU based release on different boards<br>

# Disclaimer

The information provided is released "as is" without warranty of any kind. The publisher disclaims all warranties, either express or implied, including all warranties of merchantability. No responsibility is taken for the correctness of this information.
In no event shall the publisher be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if the publisher has been advised of the possibility of such damages.

The contents of this advisory are copyright (c) 2019 by psytester and may be distributed freely provided that no fee is charged for this distribution and proper credit is given.
