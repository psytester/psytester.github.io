---
layout: post
title:  "Mehrere Schwachstellen (SSRF, XXE, XML Bombe, Admin API Zugriff, etc.) im InGrid-webmap-client geschlossen"
date:   2021-10-27 23:00:00 MEST
author: 'psytester'
---

Verschiedene Bundesländer- und Bundesportale für (Geo-)Metadaten enthielten einige Schwachstellen, die nun gefixt wurden:
- Zwei Möglichkeiten einer XXE
- XML Bombe
- SSRF auf interne Systeme. Zumindest meine Testdatei wird nun nicht mehr ausgegeben, da sie eventuell nicht der erwarteten Struktur entspricht.
- Schreibender Admin Zugriff auf Daten, die unter anderem eine persistente XSS ermöglichen können
- Tomcat Version Disclosure Schwachstelle & Veralteter Tomcat Softwarestand

TL;DR:<br>
Ziellos im Internet unterwegs gewesen, die vielen APIs vom Bundesministerium [bundDEV](https://bund.dev) entdeckt.<br>
Als Endanwender finde ich das Super Klasse all die APIs zu haben.<br>
Die Orte der E-Ladestationen entlang der Autobahnen oder das deutschlandweite Ladesäulenregister als Karte der Bundesnetzagentur sind noch nicht allen bekannt.<br>
Bei mir um die Ecke gibt's also 3 Ladesäulen, die kennt nicht mal Google....<br>
Die Interpol Fahndungsliste angesehen, rumgespielt, Fehlermeldung bekommen mit der Erkenntnis, das eine MongoDB angebunden ist: `{"name":"MongoError","message":"Regular expression cannot contain an embedded null byte"}`. Alle Datensätze (Stand heute 7684) bekommt man also, wie auch auf der [Interpol Seite direkt angeboten](https://www.interpol.int/How-we-work/Notices/View-Red-Notices) über diese Query-Abfrage: /notices/v1/red?name=.*<br>

Über das Bundesministerium [bundDEV](https://bund.dev) bin ich dann über das [Issue 41](https://github.com/bundesAPI/sofortmassnahmen/issues/41) der Sofortmaßnahmen auf den MetaDaten Portal Verbund [MetaVer.de](https://metaver.de) der Bundesländer Brandenburg, Bremen, Hamburg, Mecklenburg-Vorpommern, Saarland, Sachsen & Sachsen-Anhalt gestoßen.<br>
Details zur hier angesprochenen und zugrunde liegenden Software findet man auf [https://www.ingrid-oss.eu](https://www.ingrid-oss.eu) und der Source Code liegt auf [Github](https://github.com/informationgrid/ingrid-webmap-client)<br>
Es gibt mind. 6 Bundes und Bundesländer Portale, die diese Software einsetzen. Mit dieser [Google-Suche](https://www.google.de/search?q=inurl:ingrid-webmap-client&filter=0) findet man diese 6 Portale:<br>
https://fs.nlphh.de<br>
https://ingrid.s-h.nokis.org<br>
https://metaver.de<br>
https://numis.niedersachsen.de<br>
https://portalu.rlp.de<br>
https://www.kuestendaten.de<br>

Die Kommunikation mit dem verantwortlichen Betreiber und dessen Reaktionsgeschwindigkeit war sehr gut und professionell. Schneller konnte man die Schwachstellen nicht schließen.


# Timeline
2021-10-01 01:00 Uhr Report an metaver.de und das CERT-Bund (Es ist Freitag "Morgen")<br>
2021-10-04 Sourcen des InGrid-webmap-client analysieren und einen eigenen Client compilieren für lokale Tests<br>
2021-10-05 E-Mail mit neuen Details an hinterlegte E-Mail Adresse auf [https://www.ingrid-oss.eu](https://www.ingrid-oss.eu)<br>
2021-10-05 Rückmeldung bekommen über erste kurzfristige Korrekturen schon am Freitag<br>
2021-10-06 Retest des Fix im develop-Branch / Report neuer Details<br>
2021-10-07 Alle gemeldeten Probleme wurden in einem Nachtest final als gelöst bestätigt<br>
2021-10-27 Veröffentlichung der gefixten Schwachstellen


# Disclaimer

The information provided is released "as is" without warranty of any kind. The publisher disclaims all warranties, either express or implied, including all warranties of merchantability. No responsibility is taken for the correctness of this information.
In no event shall the publisher be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if the publisher has been advised of the possibility of such damages.

The contents of this advisory are copyright (c) 2021 by psytester and may be distributed freely provided that no fee is charged for this distribution and proper credit is given.
